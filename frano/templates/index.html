{% extends "base.html" %}
{% load frano_filters %}

{% block title %}Frano: Portfolio Management Improved{% endblock %}

{% block pageHeader %}
  <div class="eight columns">
    <div class="pageHeading">Frano - Simple Portfolio Tracking</div>
    <br style="clear:both;"/> 
  </div>
{% endblock %}

{% block mainContent %}
  <div id="mainContent" >
  
    {% if request.GET.loginFailed %}
      <div class="message">Login Failed...sorry :(</div>
    {% endif %}
    
    <div class="column-row">                
      <div class="eight columns">
        <div class="homepageCopy">
          <strong class="highlight">No marketing, no bullshit, just portfolios</strong>
          <br/>
          Play around with the sample portfolio below to see how we present your data to you. 
          One thing to keep in mind is that the sample portfolio is position based while the real ones are
          transaction based, allowing us to give you a deeper view of how it is doing.
        </div>
      </div>
    </div>
    
    <div class="column-row">                
      <div class="three columns">
        <ul class="importantData">
          <li class="name">Market Value</li>
          <li class="value">${{ summary.market_value|num_format }}</li>
          <li class="related"><strong>Cost Basis</strong> ${{ summary.cost_basis|num_format }}</li>
        </ul>
      </div>
      
      <div class="three columns">
        <ul class="importantData">
          <li class="name">Profit Loss</li>
          <li class="value {{ summary.pl|sign_choice:'pos,neg,' }}">${{ summary.pl|num_format }}</li>
          <li class="related">
            <strong>Overall</strong> <span class="{{ summary.pl_percent|sign_choice:'pos,neg,' }}"">{{ summary.pl_percent|floatformat:'2' }}%</span>
            &nbsp;&nbsp;&nbsp;&nbsp;
            <strong>Annualized</strong> <span class="{{ summary.pl_percent|sign_choice:'pos,neg,' }}">{{ summary.annualized_pl_percent|floatformat:'2' }}%</span>
          </li>
        </ul>
      </div>

      <div class="two columns">
        <ul class="importantData">
          <li class="name">XIRR</li>
          <li class="value {{ summary.xirr_percent|sign_choice:'pos,neg,' }}">{{ summary.xirr_percent|floatformat:2 }}%</li>
          <li class="related"></li>
        </ul>
      </div>
    </div>
  
    <div class="column-row">
      <div class="eight columns">
        <table class="holdingsTable" width="100%" cellpadding="0" cellspacing="0">
          <thead>
            <tr>
              <td>% of Allocation</td>
              <td>Symbol/Name</td>
              <td>Qty</td>
              <td>Price/Cost</td>
              <td>Mkt Value</td>                                
              <td>Day's P/L</td>
              <td>P/L %</td>
            </tr>
          </thead>
          <tbody>

            {% for position in positions %}
              <tr>
                <td id="allocation">{{ position.allocation|floatformat:'2' }}%</td>
                <td>
                  <div class="tickerSymbol">{{ position.symbol }}</div>
                  <div class="holdingsMeta">{{ position.name }}</div>
                </td>
                <td>{{ position.quantity|num_format }}</td>
                <td>
                  <div>${{ position.price|num_format }}</div>
                  <div class="holdingsMeta">${{ position.cost_price|num_format }}</div>
                </td>
                <td>${{ position.market_value|num_format }}</td>
                <td class="{{ position.day_pl|sign_choice:'pos,neg,' }}">
                  ${{ position.day_pl|num_format }}
                  <div class="holdingsMeta">{{ position.day_pl_percent|floatformat:2 }}%</div>
                </td>
                <td class="{{ position.pl|sign_choice:'pos,neg,' }}">
                  ${{ position.pl|num_format }}
                  <div class="holdingsMeta">{{ position.pl_percent|floatformat:2 }}%</div>
                </td>
              </tr>

            {% endfor %}
            
            <tr class="lastRow">
              <td colspan="5">&nbsp;</td>
              <td class="{{ summary.day_pl|sign_choice:'pos,neg,' }}">
                ${{ summary.day_pl|num_format }}
                <div class="holdingsMeta">{{ summary.day_pl_percent|floatformat:2 }}%</div>
              </td>
              <td class="{{ summary.pl|sign_choice:'pos,neg,' }}">
                ${{ summary.pl|num_format }}
                <div class="holdingsMeta">{{ summary.pl_percent|floatformat:2 }}%</div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
{% endblock %}

{% comment %}
  Copyright (c) 2010 Gennadiy Shafranovich
  Licensed under the MIT license
  see LICENSE file for copying permission.
{% endcomment %}