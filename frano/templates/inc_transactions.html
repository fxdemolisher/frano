{% load frano_filters %}

{% if transaction_sets.0 %}
   
  <div id="content" >
     <div class="column-row export-transactions-form">
      <div class="four columns">
        <div class="transactionsCopy">
          See transactions for: 
          <form method="get" action="" id="transactionSymbolFilter">
            <select name="filter">
              <option value="">All Symbols</option>
              <option value="*CASH" {% ifequal symbol_filter "*CASH" %}selected{% endifequal %}>Cash</option>
              {% for symbol in symbols|sorted_set %}
                <option {% ifequal symbol_filter symbol %}selected{% endifequal %}>{{ symbol }}</option>
              {% endfor %}
            </select>
          </form> 
        </div>
      </div>
      <div class="four columns">
       <div class="transactionsCopy floatright">
         If you need to start over: <a href="/{{portfolio.id}}/removeAllTransactions.html" class="buttonLink importButton removeAllTransactions">Remove All Transactions</a>
       </div>
     </div>
   </div>
    <div class="column-row">
      <div class="eight columns">
        <table class="dataTable transactionTable" width="100%" cellpadding="0" cellspacing="0">
          <thead>
            <tr>
              <td>Type</td>
              <td>Date</td>
              <td>Symbol</td>
              <td>Qty</td>
              <td>Price</td>
              <td>Total</td>
              <td>Linked To</td>
              <td>&nbsp;</td>
            </tr>
          </thead>
          <tbody>
          
            {% for transaction_set in transaction_sets %}
              {% for transaction in transaction_set %}
                <tr class="transactionRow {% if forloop.parentloop.last %}hidden{% endif %}">
                  <td>
                    <div class="inline-editable transactionType {{ transaction.type|lower }}" id="edit_{{ portfolio.id }}_{{ transaction.id }}"">{{ transaction.type }}</div>
                    <div class="inline-editable-prompt">click to edit</div>
                  </td>
                  <td>
                    <div class="inline-editable editable-transaction-field" id="edit_{{ portfolio.id }}_{{ transaction.id }}_date_83">{{ transaction.as_of_date|date:'m/d/Y' }}</div>
                    <div class="inline-editable-prompt">click to edit</div>
                  </td>
                  <td>
                    {% ifnotequal transaction.symbol "*CASH" %}
                      <div class="inline-editable editable-transaction-field" id="edit_{{ portfolio.id }}_{{ transaction.id }}_symbol_59 tickerSymbol">{{ transaction.symbol }}</div>
                      <div class="inline-editable-prompt">click to edit</div>
                    {% else %}
                      {{ transaction.symbol }}
                    {% endifnotequal %}
                  </td>
                  <td>
                    {% ifnotequal transaction.symbol "*CASH" %}
                      <div class="inline-editable editable-transaction-field" id="edit_{{ portfolio.id }}_{{ transaction.id }}_quantity_83">{{ transaction.quantity|num_format }}</div>
                      <div class="inline-editable-prompt">click to edit</div>
                    {% else %}
                      {{ transaction.quantity|num_format }}
                    {% endifnotequal %}
                  </td>
                  <td>
                    {% ifnotequal transaction.symbol "*CASH" %}
                      <div class="inline-editable editable-transaction-field" id="edit_{{ portfolio.id }}_{{ transaction.id }}_price_83">${{ transaction.price|num_format }}</div>
                      <div class="inline-editable-prompt">click to edit</div>
                    {% else %}
                      ${{ transaction.price|num_format }}
                    {% endifnotequal %}
                  </td>
                  <td>
                    <div class="inline-editable editable-transaction-field" id="edit_{{ portfolio.id }}_{{ transaction.id }}_total_83">${{ transaction.total|num_format }}</div>
                    <div class="inline-editable-prompt">click to edit</div>
                  </td>
                  <td>
                    <div class="inline-editable editable-transaction-field" id="edit_{{ portfolio.id }}_{{ transaction.id }}_linkedsymbol_59">{{ transaction.linked_symbol|default_if_none:"     " }}</div>
                    <div class="inline-editable-prompt">click to edit</div>
                  </td>
                  <td><a class="deleteTransaction" href="/{{ portfolio.id }}/{{transaction.id}}/remove.html"><div class="icon delete"></div></a></td>
                </tr>
              {% endfor %}
            {% endfor %}
            
            {% if transaction_sets.1 %}
              <tr id="seeAllTransactions"><td colspan="8" align="center"><a href="#">See All Transactions</a></td></tr>
            {% endif %}
      
          </tbody>
        </table>
      
         
           <div class="transactionsCopy exportTransactions">
             Export all your transactions as: 
             <a href="/{{portfolio.id}}/exportTransactions.csv" class="buttonLink importButton">CSV</a> /
             <a href="/{{portfolio.id}}/exportTransactions.ofx" class="buttonLink importButton">OFX</a> 
           </div>
         
      </div>
    </div>
  </div>

{% endif %}

{% comment %}
  Copyright (c) 2010 Gennadiy Shafranovich
  Licensed under the MIT license
  see LICENSE file for copying permission.
{% endcomment %}