{% load frano_filters %}

<div class="column-row">
  <div class="eight columns">
    <table class="dataTable positionTable" width="100%" cellpadding="0" cellspacing="0">
      <thead>
        <tr>
          <td class="left">Symbol</td>
          <td>Allocation</td>
          <td>Qty</td>
          <td>Price</td>
          <td>Cost Price</td>
          <td>Mkt Value</td>                                
          <td>Day's P/L $</td>
          <td>Day's P/L %</td>
          <td>P/L $</td>
          <td>P/L %</td>
        </tr>
      </thead>
      <tbody>

        {% for position in positions %}
          {% ifnotequal position.quantity 0 %}
            <tr>
              <td class="left">
                {% ifequal position.symbol '*CASH' %}
                  <div class="tickerSymbol">{{ position.symbol }}</div>
                {% else %}
                  <a href="http://finance.yahoo.com/q?s={{ position.symbol|lower }}" class="tickerSymbol" target="_blank" title="{{ position.name }}">{{ position.symbol }}</a>
                {% endifequal %}
                
                {% ifequal position.price 0 %}
                  <div class="holdingsMeta error">Unknown symbol</div>
                {% endifequal %}
              </td>
              <td>{{ position.allocation|floatformat:'2' }}%</td>
              <td>{{ position.quantity|num_format }}</td>
              <td>${{ position.price|num_format }}</td>
              <td>${{ position.cost_price|num_format }}</td>
              <td>${{ position.market_value|num_format }}</td>
              <td class="{{ position.day_pl|sign_choice:'pos,neg,' }}">${{ position.day_pl|num_format }}</td>
              <td class="{{ position.day_pl|sign_choice:'pos,neg,' }}">{{ position.day_pl_percent|floatformat:2 }}%</td>
              <td class="{{ position.pl|sign_choice:'pos,neg,' }}">${{ position.pl|num_format }}</td>
              <td class="{{ position.pl|sign_choice:'pos,neg,' }}">{{ position.pl_percent|floatformat:2 }}%</td>
            </tr>
          {% endifnotequal %}
        {% endfor %}
        
        <tr class="lastRow">
          <td colspan="5">&nbsp;</td>
          <td class="{{ summary.day_pl|sign_choice:'pos,neg,' }}">${{ summary.day_pl|num_format }}</td>
          <td class="{{ summary.day_pl|sign_choice:'pos,neg,' }}">{{ summary.day_pl_percent|floatformat:2 }}%</td>
          <td class="{{ summary.pl|sign_choice:'pos,neg,' }}">${{ summary.pl|num_format }}</td>
          <td class="{{ summary.pl|sign_choice:'pos,neg,' }}">{{ summary.pl_percent|floatformat:2 }}%</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

{% comment %}
  Copyright (c) 2010 Gennadiy Shafranovich
  Licensed under the MIT license
  see LICENSE file for copying permission.
{% endcomment %}